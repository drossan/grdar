<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>grdar/core</title>
<link rel="stylesheet" href="https://stackedit.io/res-min/themes/base.css" />
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body><div class="container"><h1 id="mini-framework-php">Mini Framework PHP!</h1>



<h2 id="estructura">Estructura</h2>

<ul>
<li><i class="icon-folder-open"></i>  src <br>
<ul><li><i class="icon-folder-open"></i> Controllers</li>
<li><i class="icon-folder-open"></i> Database</li>
<li><i class="icon-folder-open"></i> Facades</li>
<li><i class="icon-folder-open"></i> Login</li>
<li><i class="icon-folder-open"></i> Pagination</li>
<li><i class="icon-folder-open"></i> Paths</li>
<li><i class="icon-folder-open"></i> Pagination</li>
<li><i class="icon-folder-open"></i> PHPMailer</li>
<li><i class="icon-folder-open"></i> Routes</li>
<li><i class="icon-folder-open"></i> Sorteable</li>
<li><i class="icon-folder-open"></i> Views</li>
<li><i class="icon-file"></i> Container.php</li>
<li><i class="icon-file"></i> Magig.php</li>
<li><i class="icon-file"></i> Model.php</li></ul></li>
</ul>



<h2 id="uso">Uso</h2>

<blockquote>
  <p><strong>1. Crear la siguiente extructura:</strong> </p>
  
  <ul>
  <li><i class="icon-folder-open"></i>  <a href="#carpeta-core">Core </a> <br>
  <ul><li><i class="icon-folder-open"></i>  Classes <br>
  <ul><li><i class="icon-folder-open"></i>  Controllers</li>
  <li><i class="icon-folder-open"></i>  Facades</li>
  <li><i class="icon-file"></i>  archivo_clase.php</li></ul></li>
  <li><i class="icon-folder-open"></i>  Utils <br>
  <ul><li><i class="icon-file"></i>  helpers.php</li></ul></li>
  <li><i class="icon-folder-open"></i>  vendor</li>
  <li><i class="icon-file"></i>  <a href="#archivo-constantes">constantes.php</a></li>
  <li><i class="icon-file"></i>  <a href="#archivo-init">init.php</a></li>
  <li><i class="icon-file"></i>  <a href="#archivo-composer">composer.php</a> <br>
  <ul><li><i class="icon-folder-open"></i>  assets</li></ul></li>
  <li><i class="icon-folder-open"></i>  css</li>
  <li><i class="icon-folder-open"></i>  js</li>
  <li><i class="icon-folder-open"></i>  fonts</li>
  <li><i class="icon-folder-open"></i>  img <br>
  <ul><li><i class="icon-folder-open"></i>  inc</li></ul></li>
  <li><i class="icon-file"></i>  head.php</li>
  <li><i class="icon-file"></i>  header.php</li>
  <li><i class="icon-file"></i>  footer.php <br>
  <ul><li><i class="icon-folder-open"></i>  views</li></ul></li>
  <li><i class="icon-folder-open"></i>  partials <br>
  <ul><li><i class="icon-file"></i>  home.php</li></ul></li>
  <li><i class="icon-file"></i>  index.php <br>
  <ul><li><i class="icon-file"></i>  <a href="#archivo-index">index.php</a></li>
  <li><i class="icon-file"></i>  <a href="#archivo-htaccess">.htaccess</a></li></ul></li></ul></li>
  </ul>
</blockquote>

<hr>

<blockquote>
  <p><strong>2. Con una terminal ir a la carpeta Core y ejecutar los siguientes comanados:</strong></p>
  
  <blockquote>
    <ol>
    <li>composer install</li>
    <li>composer dump-autoload</li>
    <li><a href="#archivo-constantes">Crear las constantes que apunten a la carpeta de las vistas y de los includes</a></li>
    </ol>
  </blockquote>
</blockquote>

<hr>

<blockquote>
  <p><strong>3. Definir las rutas en el archivo <a href="#archivo-index">index</a></strong></p>
</blockquote>

<hr>

<blockquote>
  <p><strong>4. Crear el controlador para esa ruta</strong></p>
  
  <blockquote>
    <p>Dentro de la carpeta core/classes/controller crear un nuevo <a href="#ejemplo-archivo-indexcontroller">archivo</a>: <br>
    Registrar en el archivo <a href="#archivo-init">init.php</a></p>
  </blockquote>
</blockquote>

<hr>

<blockquote>
  <p><strong>5. Crear la vista para ese archivo</strong> <br>
  Dentro de la carpeta views crear un archivo con el nombre de la ruta:</p>
  
  <blockquote>
    <p>El nombre del archivo a de corresponder con la vista que se le pasa en el controlador: <br>
    Para la vista del paso 4  (return View::view(‘index’);), en la carpeta Views deberá existir el archivo index.php.</p>
  </blockquote>
</blockquote>

<hr>

<blockquote>
  <h4 id="carpeta-core"><strong>Carpeta core</strong>:</h4>
  
  <p>Contiene todo el corazón de la aplicación.  <br>
  1. Clases: <br>
  - Controllers: para controlar las vistas. <br>
  - Facades: para usar clases dinámicas de forma estática <br>
  - Todas las clases <br>
  2. Utils: <br>
  - Archivo helpers: funciones que no van dentro de una clase. <br>
  3. vendor: se crear al ejecutar composer install <br>
  4. Archivo <a href="#archivo-init">init</a>: </p>
  
  <blockquote>
    <p>Este archivo engloba la configuración global donde asignamos un alias para poder hacer uso de los <a href="#facades">Facades</a> y haremos uso de la <a href="#inyección-de-dependencias">inyección de dependencias</a> para las diferentes clases. </p>
  </blockquote>
</blockquote>

<hr>

<blockquote>
  <h4 id="carpeta-assets"><strong>Carpeta assets</strong>:</h4>
</blockquote>

<hr>

<blockquote>
  <h4 id="carpeta-inc"><strong>Carpeta inc</strong>:</h4>
</blockquote>

<hr>

<blockquote>
  <h4 id="carpeta-views"><strong>Carpeta views</strong>:</h4>
</blockquote>

<hr>

<blockquote>
  <p><strong>EJEMPLOS ARCHIVOS  CARPETA CORE:</strong> </p>
</blockquote>

<hr>

<blockquote>
  <h4 id="archivo-constantes"><strong>Archivo constantes</strong>:</h4>
  
  <p><strong>Conexión a la bd (obligatorio)</strong> <br>
  define(“DB_HOST”,  ‘localhost’); <br>
  define(“DB_DATABASE”,  ‘gmadees_grupoava’); <br>
  define(“DB_USERNAME”,  ‘root’); <br>
  define(“DB_PASSWORD”,  ”);</p>
  
  <p><strong>Básicos (obligatorio)</strong> <br>
  define(“BASE_URL”,  ‘<a href="http://grupoava.dev/">http://grupoava.dev/</a>‘); <br>
  define(“HASH”,  ‘121512’); <br>
  define(“ROWSPERPAGE”,  ‘6’); <br>
  define(“CHANGELIMIT”,  ‘false’); <br>
  define(“ROWSPERPAGE_OPTION”, ”); <br>
  define(‘PAGE’,  ‘pagina/’); <br>
  define(‘LIMIT’,  ‘/limit/’);</p>
  
  <p><strong>Includes y vistas</strong> <br>
      define(‘PATH_INCLUDES’,  ‘includes/’); <br>
      define(‘PATH_VIEWS’,  ‘views/’);</p>
  
  <p><strong>Constantes para usar PHPMailer</strong> <br>
      define(‘PHPMAILER_HOST’, ‘smtp.gmail.com’); <br>
      define(‘PHPMAILER_SMTPAUTH’, ‘true’); <br>
      define(‘PHPMAILER_USERNAME’, ‘test@gmail.com’); <br>
      define(‘PHPMAILER_PASSWORD’, ‘pass’); <br>
      define(‘PHPMAILER_SMTPSECURE’, ‘tls’); <br>
      define(‘PHPMAILER_PORT’, 587); <br>
      define(‘PHPMAILER_CHARSET’, ‘UTF-8’); <br>
      define(‘PHPMAILER_SETFROM’, ‘test@gmail.com’); <br>
      define(‘PHPMAILER_ADDTOREPLY’, ‘test@gmail.com’); <br>
      define(‘PHPMAILER_ISHTML’, true);</p>
</blockquote>

<hr>

<blockquote>
  <h4 id="archivo-init"><strong>Archivo init</strong>:</h4>
</blockquote>

<pre><code>&lt;?php
namespace GRDAR;

use Grdar\core\Container;
use Grdar\core\Views\View;
use Grdar\core\Paths\Paths;
use Grdar\core\Routes\Router;
use Symfony\Component\Dotenv\Dotenv;
/********************************************************/
/*********************** CLASS **************************/
require_once __DIR__.'/vendor/autoload.php';
require_once __DIR__.'/constantes.php';

// Uso de inyección de dependencias
$container = Container::getInstance();
\Grdar\core\Facades\Facade::setContainer($container);

// Una línea por cada archivo de la carpeta Facades
class_alias('GRDAR\Facades\Router', 'Rout');
class_alias('GRDAR\Facades\View', 'View');


// Una línea por cada archivo de la carpeta Controllers
class_alias('GRDAR\Controllers\IndexController', 'Index');

// Una línea por cada classe que tengamos y sea dinámica 
$router = new Router;
$View   = new View;
$Mail = new Mail;

// Una línea por cada classe que tengamos y sea dinámica 
$container-&gt;instance('Rout', $router);
$container-&gt;instance('View', $View);
$container-&gt;instance('Mail', $Mail);


// Errores
// $whoops = new \Whoops\Run;
// $whoops-&gt;pushHandler(new \Whoops\Handler\PrettyPageHandler);
// $whoops-&gt;register(); 
</code></pre>

<hr>

<blockquote>
  <h4 id="archivo-composer"><strong>Archivo composer</strong>:</h4>
  
  <p>En este archivo incluimos paquetes de terceros</p>
</blockquote>

<pre><code>{
    "name": "grdar/grupoava",
    "description": "Nombre del proyecto",
    "type": "project",
    "license": "",
    "authors": [{
        "name": "Team developer GRDAR",
        "email": "email desarrollador"
    }],
    "require": {
        "filp/whoops": "^2.1",
        "grdar/core": "^1.6"
    },
    "autoload": {
        "files": ["utils/helpers.php"],
        "psr-4": {
            "GRDAR\\": "classes/"
        }
    }
}
</code></pre>

<hr>

<blockquote>
  <h4 id="archivo-index"><strong>ARCHIVO  index:</strong></h4>
</blockquote>

<pre><code>ob_start();
session_start();

require_once __DIR__.'/core/init.php';  

Rout::setRequest($_SERVER['REQUEST_URI']);
Rout::add('/', 'Index::index');

Rout::add('/momentos', 'Momentos::index');
Rout::add('/momentos/tipo/:tipo', 'Momentos::momentosTipo');

Rout::run();
</code></pre>

<hr>

<blockquote>
  <h4 id="archivo-htaccess"><strong>ARCHIVO  .htaccess</strong></h4>
</blockquote>

<pre><code>&lt;IfModule mod_rewrite.c&gt;  
    &lt;IfModule mod_negotiation.c&gt;
        Options -MultiViews
    &lt;/IfModule&gt;
    RewriteEngine On

    # Redirect Trailing Slashes...
    RewriteRule ^(.*)/$ /$1 [L,R=301]

    # Handle Front Controller...
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^ index.php [L]
&lt;/IfModule&gt;  
</code></pre>

<blockquote>
  <h4 id="ejemplo-archivo-indexcontroller"><strong>EJEMPLO ARCHIVO IndexController  </strong></h4>

<pre><code>&lt;?php 
namespace GRDAR\Controllers;
use GRDAR\View;
use Grdar\core\Routes\Router;
class IndexController
{
    public static function index($idioma)
    {
       self::$paginaActual = 'index';
       $_REQUEST['page'] = 'index';
       return View::view('index');
   }
}
</code></pre>
</blockquote>

<hr>

<blockquote>
  <h4 id="ejemplo-facade"><strong>EJEMPLO FACADE  </strong></h4>
</blockquote>

<pre><code>&lt;?php 
namespace GRDAR\Facades;

use  Grdar\core\Facades\Facade;

class Actividad extends Facade
{
    public static function getAccessor()
    {
        return 'Actividad';
    }
}
</code></pre>

<hr>

<blockquote>
  <h4 id="inyección-de-dependencias"><strong>INYECCIÓN DE DEPENDENCIAS  </strong></h4>
  
  <p>Con la inyección de dependencias conseguimos instanciar una clase una vez y tenerla disponible en toda la aplicación sin necesidad de tener que volver a instanciarla. <br>
   Para ello haremos uso de la clase Grdar\core\Container el cual deberemos añadir a nuestro archivo init de la siguiente forma: <br>
   <code>use Grdar\core\Container;</code>  <br>
   Luego añadimos la clase al container: <br>
   <code>$actividad  = new Actividad;</code> <br>
   <code>$container-&gt;instance('Actividad', $actividad);</code> <br>
  *Si no hacemos hacemos uso de los Facades, usaremos llamaremos a la clase de la siguiente forma: </p>
  
  <p><code>$Actividad = Container::getInstance()-&gt;make('Actividad');</code> <br>
   <code>$Actividad-&gt;check('15');</code></p>
</blockquote>

<hr>

<blockquote>
  <h4 id="uso-de-facades"><strong>USO DE FACADES  </strong></h4>
  
  <p>Con el uso de Facades logramos usar clases usar clases dinámicas de forma estática. Para esto dentro de la carpeta core/facades creamos un <a href="#ejemplo-facade">archivo</a> con el nombre de la clase  y dentro del archivo init.php lo añadimos de la siguiente forma:  <br>
  <code>class_alias('GRDAR\Facades\Actividad', 'Actividades');</code> <br>
  De esta forma podemos hacer uso de la clase Actividad usando su alias: <br>
  <code>$actividad = Actividades::check(15);</code></p>
</blockquote></div></body>
</html>